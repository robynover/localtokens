function readCookie(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null}function createCookie(name,value,days){var expires="";if(days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toUTCString()}document.cookie=name+"="+value+expires+"; path=/"}$("#user-activate").on("click",function(){var checkboxes=$('input[name="userid"]'),users=[];for(var i in checkboxes)checkboxes[i].checked&&users.push(parseInt($(checkboxes[i]).val()));users.length>0?$.ajax({method:"POST",url:"/api/admin/users/activate",data:{userids:users}}).done(function(data){data.success?window.location.reload(!0):alert("There was an error updating the users")}):alert("Please select some users")}),$(".bestow form #receiver").on("blur",function(){var receiver=$(this).val();$.ajax({method:"POST",url:"/api/user/"+receiver+"/exists"}).done(function(json){json.error?($(".field-validation.receiver").removeClass("success"),$(".field-validation.receiver").addClass("error"),$(".field-validation.receiver").text(json.error)):json.success&&($(".field-validation.receiver").removeClass("error"),$(".field-validation.receiver").addClass("success"),$(".field-validation.receiver").text("user found"))})});var lastSeen=1,cb=function(p){lastSeen=p};$.ajax({url:"/api/user/notifications"}).done(function(data){if(data.success){parseInt(data.last_seen)>parseInt(readCookie("last_notify"))&&$(".button-badge").show(),cb(data.last_seen);var container=$("<ul>");for(var i in data.notifications){var li=$("<li>");li.text(data.notifications[i].message),li.append("<br>"),li.append("on "+moment(data.notifications[i].date).format("M/D [at] h:mm a")),container.append(li)}if(0==data.notifications.length){var li=$("<li>You have no notifications</li>");container.append(li)}$("nav.topnav .dropdown").html(container)}else"no results"==data.error&&$("nav.topnav .dropdown").html("<li>No new notifications</li>")}),$(".alertbell").on("mousedown",null,lastSeen,function(e){$("nav.topnav .dropdown").toggle(),$(".button-badge").hide(),createCookie("last_notify",lastSeen,30)}),$(document).on("click",function(e){!$("nav.topnav .dropdown").is(":visible")||$(e.target).hasClass("dropdown")||$(e.target).hasClass("fa-bell")||$("nav.topnav .dropdown").hide()});